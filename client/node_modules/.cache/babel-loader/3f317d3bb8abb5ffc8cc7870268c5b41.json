{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\75165\\\\Documents\\\\course\\\\CSCI571\\\\hw8\\\\client\\\\src\\\\Components\\\\DetailArticle.js\";\nimport React from \"react\";\nimport Card from \"react-bootstrap/Card\";\nimport Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport Image from \"react-bootstrap/Image\";\nimport LoadSpinner from \"./LoadSpinner\";\nimport DetailShare from \"./DetailShare\";\nimport { FaRegBookmark, FaBookmark, IoIosArrowDown, IoIosArrowUp } from \"react-icons/all\";\nimport { Element, animateScroll as scroll, scroller } from 'react-scroll';\nimport { Events } from \"react-scroll\";\nimport ReactTooltip from \"react-tooltip\";\nimport { toast, ToastContainer, Zoom } from \"react-toastify\";\nimport Comment from \"./Comment\";\n\nclass DetailArticle extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.callGuardian = id => {\n      fetch(\"https://yli59322-hw8-571-backend.appspot.com/guardian/article\" + id).then(res => res.json()).then(res => {\n        this.setState({\n          isLoaded: true,\n          data: res['response']['content']\n        });\n      }, error => {\n        this.setState({\n          isLoaded: true,\n          error\n        });\n      }).then(() => {\n        this.setState({\n          scrollHeight: this.desRef.current.scrollHeight\n        });\n        this.setState({\n          clientHeight: this.desRef.current.clientHeight\n        });\n        if (this.desRef.current.scrollHeight === this.desRef.current.clientHeight) document.getElementById(\"arrow-down\").style.display = \"none\";\n\n        if (this.state.bookmarkChecked) {\n          document.getElementById(\"small-bookmark-unchecked\").style.display = \"none\";\n          document.getElementById(\"small-bookmark-checked\").style.display = \"block\";\n          document.getElementById(\"big-bookmark-unchecked\").style.display = \"none\";\n          document.getElementById(\"big-bookmark-checked\").style.display = \"block\";\n        }\n      });\n    };\n\n    this.callNYTimes = id => {\n      fetch(\"https://yli59322-hw8-571-backend.appspot.com/nytimes/article\" + id).then(res => res.json()).then(res => {\n        this.setState({\n          isLoaded: true,\n          data: res['response']['docs']\n        });\n      }, error => {\n        this.setState({\n          isLoaded: true,\n          error\n        });\n      }).then(() => {\n        this.setState({\n          scrollHeight: this.desRef.current.scrollHeight\n        });\n        this.setState({\n          clientHeight: this.desRef.current.clientHeight\n        });\n        if (this.desRef.current.scrollHeight === this.desRef.current.clientHeight) document.getElementById(\"arrow-down\").style.display = \"none\";\n\n        if (this.state.bookmarkChecked) {\n          document.getElementById(\"small-bookmark-unchecked\").style.display = \"none\";\n          document.getElementById(\"small-bookmark-checked\").style.display = \"block\";\n          document.getElementById(\"big-bookmark-unchecked\").style.display = \"none\";\n          document.getElementById(\"big-bookmark-checked\").style.display = \"block\";\n        }\n      });\n    };\n\n    this.expand = () => {\n      document.getElementById(\"small-card\").style.display = \"none\";\n      document.getElementById(\"big-card\").style.display = \"flex\";\n      this.scrollToBottom();\n    };\n\n    this.fold = () => {\n      this.scrollUp();\n    };\n\n    this.scrollToBottom = () => {\n      scroller.scrollTo('scroll-to-bottom', {\n        duration: 800,\n        delay: 0,\n        smooth: true,\n        offset: this.state.clientHeight\n      });\n    };\n\n    this.scrollUp = () => {\n      scroller.scrollTo('scroll-to-element', {\n        duration: 800,\n        delay: 0,\n        smooth: true\n      });\n    };\n\n    this.bookmarkClick = () => {\n      document.getElementById(\"small-bookmark-unchecked\").style.display = \"none\";\n      document.getElementById(\"small-bookmark-checked\").style.display = \"block\";\n      document.getElementById(\"big-bookmark-unchecked\").style.display = \"none\";\n      document.getElementById(\"big-bookmark-checked\").style.display = \"block\";\n      let title;\n      if (this.state.GuardianChecked) title = this.state.data['webTitle'];else title = this.state.data[0]['headline']['main'];\n      toast(\"Saving \" + title);\n      let bookmarks;\n\n      if (window.localStorage.getItem(\"bookmarks\")) {\n        bookmarks = JSON.parse(window.localStorage.getItem(\"bookmarks\"));\n      } else {\n        bookmarks = [];\n      }\n\n      bookmarks.push(this.state.id);\n      window.localStorage.setItem(\"bookmarks\", JSON.stringify(bookmarks));\n      console.log(JSON.parse(window.localStorage.getItem(\"bookmarks\")));\n    };\n\n    this.bookmarkUnClick = () => {\n      document.getElementById(\"small-bookmark-unchecked\").style.display = \"block\";\n      document.getElementById(\"small-bookmark-checked\").style.display = \"none\";\n      document.getElementById(\"big-bookmark-unchecked\").style.display = \"block\";\n      document.getElementById(\"big-bookmark-checked\").style.display = \"none\";\n      let title;\n      if (this.state.GuardianChecked) title = this.state.data['webTitle'];else title = this.state.data[0]['headline']['main'];\n      toast(\"Removing - \" + title);\n      let bookmarks = JSON.parse(window.localStorage.getItem(\"bookmarks\"));\n      let newbookmarks = [];\n\n      for (let i = 0; i < bookmarks.length; i++) {\n        if (bookmarks[i] !== this.state.id) newbookmarks.push(bookmarks[i]);\n      }\n\n      window.localStorage.setItem(\"bookmarks\", JSON.stringify(newbookmarks));\n      console.log(JSON.parse(window.localStorage.getItem(\"bookmarks\")));\n    };\n\n    let isBookmarked = false;\n\n    if (window.localStorage.getItem(\"bookmarks\")) {\n      let bookmarks = JSON.parse(window.localStorage.getItem(\"bookmarks\"));\n\n      for (let i = 0; i < bookmarks.length; i++) {\n        if (bookmarks[i] === props.id) {\n          isBookmarked = true;\n          break;\n        }\n      }\n    }\n\n    this.state = {\n      error: null,\n      isLoaded: false,\n      data: [],\n      GuardianChecked: props.checked,\n      id: props.id,\n      bookmarkChecked: isBookmarked\n    };\n    this.smallRef = React.createRef();\n    this.desRef = React.createRef();\n    this.bigRef = React.createRef();\n  }\n\n  componentDidMount() {\n    if (this.state.GuardianChecked) this.callGuardian(this.state.id);else this.callNYTimes(this.state.id);\n    Events.scrollEvent.register('begin', function () {\n      console.log(\"begin\", arguments);\n    });\n    Events.scrollEvent.register('end', function () {\n      console.log(\"end\", arguments);\n\n      if (arguments[0] === \"scroll-to-element\") {\n        document.getElementById(\"small-card\").style.display = \"flex\";\n        document.getElementById(\"big-card\").style.display = \"none\";\n      }\n    });\n  }\n\n  render() {\n    if (this.state.error) {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, \"Error: \", this.state.error.message);\n    } else if (!this.state.isLoaded) {\n      return React.createElement(\"div\", {\n        className: \"load-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(LoadSpinner, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }));\n    } else {\n      let title;\n      let image;\n      let date;\n      let url;\n      let description;\n\n      if (this.state.GuardianChecked) {\n        title = this.state.data['webTitle'];\n        date = this.state.data['webPublicationDate'].slice(0, 10);\n        description = this.state.data['blocks']['body']['0']['bodyTextSummary'];\n        url = this.state.data['webUrl'];\n        if ('main' in this.state.data['blocks'] && this.state.data['blocks']['main']['elements']['0']['assets'].length !== 0) image = this.state.data['blocks']['main']['elements']['0']['assets'].slice(-1)[0]['file'];else image = 'https://assets.guim.co.uk/images/eada8aa27c12fe2d5afa3a89d3fbae0d/fallback-logo.png';\n      } else {\n        title = this.state.data[0]['headline']['main'];\n        date = this.state.data[0]['pub_date'].slice(0, 10);\n        description = this.state.data[0]['abstract'];\n        url = this.state.data[0]['web_url'];\n\n        if ('multimedia' in this.state.data[0] && this.state.data[0]['multimedia'] !== null && this.state.data[0]['multimedia'].length !== 0) {\n          let i = 0;\n\n          for (; i < this.state.data[0]['multimedia'].length; i++) {\n            if (this.state.data[0]['multimedia'][i]['width'] >= 2000) break;\n          }\n\n          if (i < this.state.data[0]['multimedia'].length) {\n            let tmpUrl = this.state.data[0]['multimedia'][i]['url'];\n            if (tmpUrl[0] === 'i') image = 'https://www.nytimes.com/' + tmpUrl;else image = tmpUrl;\n          } else image = 'https://upload.wikimedia.org/wikipedia/commons/0/0e/Nytimes_hq.jpg';\n        } else image = 'https://upload.wikimedia.org/wikipedia/commons/0/0e/Nytimes_hq.jpg';\n      }\n\n      return React.createElement(\"div\", {\n        style: {\n          boxSizing: \"content-box\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }, React.createElement(ToastContainer, {\n        transition: Zoom,\n        position: \"top-center\",\n        autoClose: 3000,\n        hideProgressBar: true,\n        newestOnTop: false,\n        closeOnClick: true,\n        rtl: false,\n        pauseOnVisibilityChange: true,\n        draggable: false,\n        pauseOnHover: true,\n        bodyClassName: \"toast-body\",\n        style: {\n          \"font-size\": \"0.8rem\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }), React.createElement(Element, {\n        name: \"scroll-to-element\",\n        className: \"element\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242\n        },\n        __self: this\n      }), React.createElement(Card, {\n        className: \"detailCard\",\n        ref: this.smallRef,\n        id: \"small-card\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container-fluid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      }, React.createElement(Card.Body, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245\n        },\n        __self: this\n      }, React.createElement(Card.Title, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247\n        },\n        __self: this\n      }, React.createElement(\"em\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247\n        },\n        __self: this\n      }, title))), React.createElement(Card.Text, {\n        style: {\n          \"marginBottom\": 0\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, React.createElement(Col, {\n        md: 8,\n        sm: 5,\n        xs: 5,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        },\n        __self: this\n      }, React.createElement(\"em\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252\n        },\n        __self: this\n      }, date)), React.createElement(Col, {\n        md: 3,\n        sm: 5,\n        xs: 5,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254\n        },\n        __self: this\n      }, React.createElement(DetailShare, {\n        url: url,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255\n        },\n        __self: this\n      })), React.createElement(Col, {\n        md: 1,\n        sm: 2,\n        xs: 2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        \"data-tip\": \"Bookmark\",\n        \"data-for\": \"BookmarkDeTT\",\n        \"data-offset\": \"{'left' : -5, 'right' : -5}\",\n        style: {\n          \"float\": \"right\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }, React.createElement(FaRegBookmark, {\n        id: \"small-bookmark-unchecked\",\n        onClick: this.bookmarkClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      }), React.createElement(FaBookmark, {\n        id: \"small-bookmark-checked\",\n        onClick: this.bookmarkUnClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265\n        },\n        __self: this\n      })), React.createElement(ReactTooltip, {\n        id: \"BookmarkDeTT\",\n        place: \"top\",\n        effect: \"solid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268\n        },\n        __self: this\n      })))), React.createElement(\"div\", {\n        className: \"align-items-center justify-content-center\",\n        style: {\n          display: \"flex\",\n          width: \"100%\",\n          height: \"100%\"\n        },\n        id: \"scroll-to\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276\n        },\n        __self: this\n      }, React.createElement(Image, {\n        className: \"img-fluid\",\n        src: image,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280\n        },\n        __self: this\n      })), React.createElement(Card.Text, {\n        className: \"detailDescription\",\n        ref: this.desRef,\n        id: \"small-description\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 282\n        },\n        __self: this\n      }, description), React.createElement(IoIosArrowDown, {\n        style: {\n          \"height\": \"1.5em\",\n          \"width\": \"1.5em\",\n          \"float\": \"right\"\n        },\n        onClick: this.expand,\n        id: \"arrow-down\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 285\n        },\n        __self: this\n      })))), React.createElement(Card, {\n        className: \"detailCard\",\n        ref: this.bigRef,\n        id: \"big-card\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 293\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container-fluid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 294\n        },\n        __self: this\n      }, React.createElement(Card.Body, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295\n        },\n        __self: this\n      }, React.createElement(Card.Title, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297\n        },\n        __self: this\n      }, React.createElement(\"em\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297\n        },\n        __self: this\n      }, title))), React.createElement(Card.Text, {\n        style: {\n          \"marginBottom\": 0\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 299\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 300\n        },\n        __self: this\n      }, React.createElement(Col, {\n        md: 8,\n        sm: 5,\n        xs: 5,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301\n        },\n        __self: this\n      }, React.createElement(\"em\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 302\n        },\n        __self: this\n      }, date)), React.createElement(Col, {\n        md: 3,\n        sm: 5,\n        xs: 5,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304\n        },\n        __self: this\n      }, React.createElement(DetailShare, {\n        url: url,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305\n        },\n        __self: this\n      })), React.createElement(Col, {\n        md: 1,\n        sm: 2,\n        xs: 2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        \"data-tip\": \"Bookmark\",\n        \"data-for\": \"BookmarkDeTT\",\n        \"data-offset\": \"{'left' : -5, 'right' : -5}\",\n        style: {\n          \"float\": \"right\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 308\n        },\n        __self: this\n      }, React.createElement(FaRegBookmark, {\n        id: \"big-bookmark-unchecked\",\n        onClick: this.bookmarkClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 313\n        },\n        __self: this\n      }), React.createElement(FaBookmark, {\n        id: \"big-bookmark-checked\",\n        onClick: this.bookmarkUnClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315\n        },\n        __self: this\n      })), React.createElement(ReactTooltip, {\n        id: \"BookmarkDeTT\",\n        place: \"top\",\n        effect: \"solid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318\n        },\n        __self: this\n      })))), React.createElement(\"div\", {\n        className: \"align-items-center justify-content-center\",\n        style: {\n          display: \"flex\",\n          width: \"100%\",\n          height: \"100%\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 326\n        },\n        __self: this\n      }, React.createElement(Image, {\n        className: \"img-fluid\",\n        src: image,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 328\n        },\n        __self: this\n      })), React.createElement(Element, {\n        name: \"scroll-to-bottom\",\n        className: \"element\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 330\n        },\n        __self: this\n      }), React.createElement(Card.Text, {\n        className: \"detailDescription\",\n        id: \"big-description\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 331\n        },\n        __self: this\n      }, description), React.createElement(IoIosArrowUp, {\n        style: {\n          \"height\": \"1.5em\",\n          \"width\": \"1.5em\",\n          \"float\": \"right\"\n        },\n        onClick: this.fold,\n        id: \"arrow-up\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 334\n        },\n        __self: this\n      }))))), React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 343\n        },\n        __self: this\n      }, React.createElement(Comment, {\n        id: this.props.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 344\n        },\n        __self: this\n      })));\n    }\n  }\n\n}\n\nexport default DetailArticle;","map":{"version":3,"sources":["C:/Users/75165/Documents/course/CSCI571/hw8/client/src/Components/DetailArticle.js"],"names":["React","Card","Row","Col","Image","LoadSpinner","DetailShare","FaRegBookmark","FaBookmark","IoIosArrowDown","IoIosArrowUp","Element","animateScroll","scroll","scroller","Events","ReactTooltip","toast","ToastContainer","Zoom","Comment","DetailArticle","Component","constructor","props","callGuardian","id","fetch","then","res","json","setState","isLoaded","data","error","scrollHeight","desRef","current","clientHeight","document","getElementById","style","display","state","bookmarkChecked","callNYTimes","expand","scrollToBottom","fold","scrollUp","scrollTo","duration","delay","smooth","offset","bookmarkClick","title","GuardianChecked","bookmarks","window","localStorage","getItem","JSON","parse","push","setItem","stringify","console","log","bookmarkUnClick","newbookmarks","i","length","isBookmarked","checked","smallRef","createRef","bigRef","componentDidMount","scrollEvent","register","arguments","render","message","image","date","url","description","slice","tmpUrl","boxSizing","width","height"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,IAAP,MAAiB,sBAAjB;AACA,OAAOC,GAAP,MAAgB,qBAAhB;AACA,OAAOC,GAAP,MAAgB,qBAAhB;AACA,OAAOC,KAAP,MAAkB,uBAAlB;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,SAAQC,aAAR,EAAuBC,UAAvB,EAAmCC,cAAnC,EAAmDC,YAAnD,QAAsE,iBAAtE;AACA,SAAQC,OAAR,EAAiBC,aAAa,IAAIC,MAAlC,EAA0CC,QAA1C,QAAyD,cAAzD;AACA,SAAQC,MAAR,QAAqB,cAArB;AACA,OAAOC,YAAP,MAAyB,eAAzB;AACA,SAAQC,KAAR,EAAeC,cAAf,EAA+BC,IAA/B,QAA0C,gBAA1C;AACA,OAAOC,OAAP,MAAoB,WAApB;;AAEA,MAAMC,aAAN,SAA4BrB,KAAK,CAACsB,SAAlC,CAA4C;AACxCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;;AADe,SAyBnBC,YAzBmB,GAyBHC,EAAD,IAAQ;AACnBC,MAAAA,KAAK,CAAC,kEAAkED,EAAnE,CAAL,CACKE,IADL,CACUC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EADjB,EAEKF,IAFL,CAGQC,GAAG,IAAI;AACH,aAAKE,QAAL,CAAc;AAACC,UAAAA,QAAQ,EAAE,IAAX;AAAiBC,UAAAA,IAAI,EAAEJ,GAAG,CAAC,UAAD,CAAH,CAAgB,SAAhB;AAAvB,SAAd;AACH,OALT,EAKWK,KAAK,IAAI;AACR,aAAKH,QAAL,CAAc;AAACC,UAAAA,QAAQ,EAAE,IAAX;AAAiBE,UAAAA;AAAjB,SAAd;AACH,OAPT,EAQKN,IARL,CASQ,MAAM;AACF,aAAKG,QAAL,CAAc;AAACI,UAAAA,YAAY,EAAE,KAAKC,MAAL,CAAYC,OAAZ,CAAoBF;AAAnC,SAAd;AACA,aAAKJ,QAAL,CAAc;AAACO,UAAAA,YAAY,EAAE,KAAKF,MAAL,CAAYC,OAAZ,CAAoBC;AAAnC,SAAd;AACA,YAAI,KAAKF,MAAL,CAAYC,OAAZ,CAAoBF,YAApB,KAAqC,KAAKC,MAAL,CAAYC,OAAZ,CAAoBC,YAA7D,EACIC,QAAQ,CAACC,cAAT,CAAwB,YAAxB,EAAsCC,KAAtC,CAA4CC,OAA5C,GAAsD,MAAtD;;AACJ,YAAI,KAAKC,KAAL,CAAWC,eAAf,EAAgC;AAC5BL,UAAAA,QAAQ,CAACC,cAAT,CAAwB,0BAAxB,EAAoDC,KAApD,CAA0DC,OAA1D,GAAoE,MAApE;AACAH,UAAAA,QAAQ,CAACC,cAAT,CAAwB,wBAAxB,EAAkDC,KAAlD,CAAwDC,OAAxD,GAAkE,OAAlE;AACAH,UAAAA,QAAQ,CAACC,cAAT,CAAwB,wBAAxB,EAAkDC,KAAlD,CAAwDC,OAAxD,GAAkE,MAAlE;AACAH,UAAAA,QAAQ,CAACC,cAAT,CAAwB,sBAAxB,EAAgDC,KAAhD,CAAsDC,OAAtD,GAAgE,OAAhE;AACH;AACJ,OApBT;AAsBH,KAhDkB;;AAAA,SAkDnBG,WAlDmB,GAkDJnB,EAAD,IAAQ;AAClBC,MAAAA,KAAK,CAAC,iEAAiED,EAAlE,CAAL,CACKE,IADL,CACUC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EADjB,EAEKF,IAFL,CAGQC,GAAG,IAAI;AACH,aAAKE,QAAL,CAAc;AAACC,UAAAA,QAAQ,EAAE,IAAX;AAAiBC,UAAAA,IAAI,EAAEJ,GAAG,CAAC,UAAD,CAAH,CAAgB,MAAhB;AAAvB,SAAd;AACH,OALT,EAKWK,KAAK,IAAI;AACR,aAAKH,QAAL,CAAc;AAACC,UAAAA,QAAQ,EAAE,IAAX;AAAiBE,UAAAA;AAAjB,SAAd;AACH,OAPT,EAQKN,IARL,CASQ,MAAM;AACF,aAAKG,QAAL,CAAc;AAACI,UAAAA,YAAY,EAAE,KAAKC,MAAL,CAAYC,OAAZ,CAAoBF;AAAnC,SAAd;AACA,aAAKJ,QAAL,CAAc;AAACO,UAAAA,YAAY,EAAE,KAAKF,MAAL,CAAYC,OAAZ,CAAoBC;AAAnC,SAAd;AACA,YAAI,KAAKF,MAAL,CAAYC,OAAZ,CAAoBF,YAApB,KAAqC,KAAKC,MAAL,CAAYC,OAAZ,CAAoBC,YAA7D,EACIC,QAAQ,CAACC,cAAT,CAAwB,YAAxB,EAAsCC,KAAtC,CAA4CC,OAA5C,GAAsD,MAAtD;;AACJ,YAAI,KAAKC,KAAL,CAAWC,eAAf,EAAgC;AAC5BL,UAAAA,QAAQ,CAACC,cAAT,CAAwB,0BAAxB,EAAoDC,KAApD,CAA0DC,OAA1D,GAAoE,MAApE;AACAH,UAAAA,QAAQ,CAACC,cAAT,CAAwB,wBAAxB,EAAkDC,KAAlD,CAAwDC,OAAxD,GAAkE,OAAlE;AACAH,UAAAA,QAAQ,CAACC,cAAT,CAAwB,wBAAxB,EAAkDC,KAAlD,CAAwDC,OAAxD,GAAkE,MAAlE;AACAH,UAAAA,QAAQ,CAACC,cAAT,CAAwB,sBAAxB,EAAgDC,KAAhD,CAAsDC,OAAtD,GAAgE,OAAhE;AACH;AACJ,OApBT;AAsBH,KAzEkB;;AAAA,SA6FnBI,MA7FmB,GA6FV,MAAM;AACXP,MAAAA,QAAQ,CAACC,cAAT,CAAwB,YAAxB,EAAsCC,KAAtC,CAA4CC,OAA5C,GAAsD,MAAtD;AACAH,MAAAA,QAAQ,CAACC,cAAT,CAAwB,UAAxB,EAAoCC,KAApC,CAA0CC,OAA1C,GAAoD,MAApD;AACA,WAAKK,cAAL;AACH,KAjGkB;;AAAA,SAmGnBC,IAnGmB,GAmGZ,MAAM;AACT,WAAKC,QAAL;AACH,KArGkB;;AAAA,SAuGnBF,cAvGmB,GAuGF,MAAM;AACnBjC,MAAAA,QAAQ,CAACoC,QAAT,CAAkB,kBAAlB,EAAsC;AAClCC,QAAAA,QAAQ,EAAE,GADwB;AAElCC,QAAAA,KAAK,EAAE,CAF2B;AAGlCC,QAAAA,MAAM,EAAE,IAH0B;AAIlCC,QAAAA,MAAM,EAAE,KAAKX,KAAL,CAAWL;AAJe,OAAtC;AAMH,KA9GkB;;AAAA,SAgHnBW,QAhHmB,GAgHR,MAAM;AACbnC,MAAAA,QAAQ,CAACoC,QAAT,CAAkB,mBAAlB,EAAuC;AACnCC,QAAAA,QAAQ,EAAE,GADyB;AAEnCC,QAAAA,KAAK,EAAE,CAF4B;AAGnCC,QAAAA,MAAM,EAAE;AAH2B,OAAvC;AAKH,KAtHkB;;AAAA,SAwHnBE,aAxHmB,GAwHH,MAAM;AAClBhB,MAAAA,QAAQ,CAACC,cAAT,CAAwB,0BAAxB,EAAoDC,KAApD,CAA0DC,OAA1D,GAAoE,MAApE;AACAH,MAAAA,QAAQ,CAACC,cAAT,CAAwB,wBAAxB,EAAkDC,KAAlD,CAAwDC,OAAxD,GAAkE,OAAlE;AACAH,MAAAA,QAAQ,CAACC,cAAT,CAAwB,wBAAxB,EAAkDC,KAAlD,CAAwDC,OAAxD,GAAkE,MAAlE;AACAH,MAAAA,QAAQ,CAACC,cAAT,CAAwB,sBAAxB,EAAgDC,KAAhD,CAAsDC,OAAtD,GAAgE,OAAhE;AACA,UAAIc,KAAJ;AACA,UAAI,KAAKb,KAAL,CAAWc,eAAf,EACID,KAAK,GAAG,KAAKb,KAAL,CAAWV,IAAX,CAAgB,UAAhB,CAAR,CADJ,KAGIuB,KAAK,GAAG,KAAKb,KAAL,CAAWV,IAAX,CAAgB,CAAhB,EAAmB,UAAnB,EAA+B,MAA/B,CAAR;AACJhB,MAAAA,KAAK,CAAC,YAAYuC,KAAb,CAAL;AACA,UAAIE,SAAJ;;AACA,UAAIC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,WAA5B,CAAJ,EAA8C;AAC1CH,QAAAA,SAAS,GAAGI,IAAI,CAACC,KAAL,CAAWJ,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,WAA5B,CAAX,CAAZ;AACH,OAFD,MAEO;AACHH,QAAAA,SAAS,GAAG,EAAZ;AACH;;AACDA,MAAAA,SAAS,CAACM,IAAV,CAAe,KAAKrB,KAAL,CAAWjB,EAA1B;AACAiC,MAAAA,MAAM,CAACC,YAAP,CAAoBK,OAApB,CAA4B,WAA5B,EAAyCH,IAAI,CAACI,SAAL,CAAeR,SAAf,CAAzC;AACAS,MAAAA,OAAO,CAACC,GAAR,CAAYN,IAAI,CAACC,KAAL,CAAWJ,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,WAA5B,CAAX,CAAZ;AACH,KA5IkB;;AAAA,SA8InBQ,eA9ImB,GA8ID,MAAM;AACpB9B,MAAAA,QAAQ,CAACC,cAAT,CAAwB,0BAAxB,EAAoDC,KAApD,CAA0DC,OAA1D,GAAoE,OAApE;AACAH,MAAAA,QAAQ,CAACC,cAAT,CAAwB,wBAAxB,EAAkDC,KAAlD,CAAwDC,OAAxD,GAAkE,MAAlE;AACAH,MAAAA,QAAQ,CAACC,cAAT,CAAwB,wBAAxB,EAAkDC,KAAlD,CAAwDC,OAAxD,GAAkE,OAAlE;AACAH,MAAAA,QAAQ,CAACC,cAAT,CAAwB,sBAAxB,EAAgDC,KAAhD,CAAsDC,OAAtD,GAAgE,MAAhE;AACA,UAAIc,KAAJ;AACA,UAAI,KAAKb,KAAL,CAAWc,eAAf,EACID,KAAK,GAAG,KAAKb,KAAL,CAAWV,IAAX,CAAgB,UAAhB,CAAR,CADJ,KAGIuB,KAAK,GAAG,KAAKb,KAAL,CAAWV,IAAX,CAAgB,CAAhB,EAAmB,UAAnB,EAA+B,MAA/B,CAAR;AACJhB,MAAAA,KAAK,CAAC,gBAAgBuC,KAAjB,CAAL;AACA,UAAIE,SAAS,GAAGI,IAAI,CAACC,KAAL,CAAWJ,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,WAA5B,CAAX,CAAhB;AACA,UAAIS,YAAY,GAAG,EAAnB;;AACA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGb,SAAS,CAACc,MAA9B,EAAsCD,CAAC,EAAvC,EAA2C;AACvC,YAAIb,SAAS,CAACa,CAAD,CAAT,KAAiB,KAAK5B,KAAL,CAAWjB,EAAhC,EACI4C,YAAY,CAACN,IAAb,CAAkBN,SAAS,CAACa,CAAD,CAA3B;AACP;;AACDZ,MAAAA,MAAM,CAACC,YAAP,CAAoBK,OAApB,CAA4B,WAA5B,EAAyCH,IAAI,CAACI,SAAL,CAAeI,YAAf,CAAzC;AACAH,MAAAA,OAAO,CAACC,GAAR,CAAYN,IAAI,CAACC,KAAL,CAAWJ,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,WAA5B,CAAX,CAAZ;AACH,KAjKkB;;AAEf,QAAIY,YAAY,GAAG,KAAnB;;AACA,QAAId,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,WAA5B,CAAJ,EAA8C;AAC1C,UAAIH,SAAS,GAAGI,IAAI,CAACC,KAAL,CAAWJ,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,WAA5B,CAAX,CAAhB;;AACA,WAAK,IAAIU,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGb,SAAS,CAACc,MAA9B,EAAsCD,CAAC,EAAvC,EAA2C;AACvC,YAAIb,SAAS,CAACa,CAAD,CAAT,KAAiB/C,KAAK,CAACE,EAA3B,EAA+B;AAC3B+C,UAAAA,YAAY,GAAG,IAAf;AACA;AACH;AACJ;AACJ;;AACD,SAAK9B,KAAL,GAAa;AACTT,MAAAA,KAAK,EAAE,IADE;AAETF,MAAAA,QAAQ,EAAE,KAFD;AAGTC,MAAAA,IAAI,EAAE,EAHG;AAITwB,MAAAA,eAAe,EAAEjC,KAAK,CAACkD,OAJd;AAKThD,MAAAA,EAAE,EAAEF,KAAK,CAACE,EALD;AAMTkB,MAAAA,eAAe,EAAE6B;AANR,KAAb;AAQA,SAAKE,QAAL,GAAgB3E,KAAK,CAAC4E,SAAN,EAAhB;AACA,SAAKxC,MAAL,GAAcpC,KAAK,CAAC4E,SAAN,EAAd;AACA,SAAKC,MAAL,GAAc7E,KAAK,CAAC4E,SAAN,EAAd;AACH;;AAoDDE,EAAAA,iBAAiB,GAAG;AAChB,QAAI,KAAKnC,KAAL,CAAWc,eAAf,EACI,KAAKhC,YAAL,CAAkB,KAAKkB,KAAL,CAAWjB,EAA7B,EADJ,KAGI,KAAKmB,WAAL,CAAiB,KAAKF,KAAL,CAAWjB,EAA5B;AACJX,IAAAA,MAAM,CAACgE,WAAP,CAAmBC,QAAnB,CAA4B,OAA5B,EAAqC,YAAY;AAC7Cb,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBa,SAArB;AACH,KAFD;AAIAlE,IAAAA,MAAM,CAACgE,WAAP,CAAmBC,QAAnB,CAA4B,KAA5B,EAAmC,YAAY;AAC3Cb,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAmBa,SAAnB;;AACA,UAAIA,SAAS,CAAC,CAAD,CAAT,KAAiB,mBAArB,EAA0C;AACtC1C,QAAAA,QAAQ,CAACC,cAAT,CAAwB,YAAxB,EAAsCC,KAAtC,CAA4CC,OAA5C,GAAsD,MAAtD;AACAH,QAAAA,QAAQ,CAACC,cAAT,CAAwB,UAAxB,EAAoCC,KAApC,CAA0CC,OAA1C,GAAoD,MAApD;AACH;AACJ,KAND;AAOH;;AAwEDwC,EAAAA,MAAM,GAAG;AACL,QAAI,KAAKvC,KAAL,CAAWT,KAAf,EAAsB;AAClB,aAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAa,KAAKS,KAAL,CAAWT,KAAX,CAAiBiD,OAA9B,CAAP;AACH,KAFD,MAEO,IAAI,CAAC,KAAKxC,KAAL,CAAWX,QAAhB,EAA0B;AAC7B,aACI;AAAK,QAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,CADJ;AAKH,KANM,MAMA;AACH,UAAIwB,KAAJ;AACA,UAAI4B,KAAJ;AACA,UAAIC,IAAJ;AACA,UAAIC,GAAJ;AACA,UAAIC,WAAJ;;AACA,UAAI,KAAK5C,KAAL,CAAWc,eAAf,EAAgC;AAC5BD,QAAAA,KAAK,GAAG,KAAKb,KAAL,CAAWV,IAAX,CAAgB,UAAhB,CAAR;AACAoD,QAAAA,IAAI,GAAG,KAAK1C,KAAL,CAAWV,IAAX,CAAgB,oBAAhB,EAAsCuD,KAAtC,CAA4C,CAA5C,EAA+C,EAA/C,CAAP;AACAD,QAAAA,WAAW,GAAG,KAAK5C,KAAL,CAAWV,IAAX,CAAgB,QAAhB,EAA0B,MAA1B,EAAkC,GAAlC,EAAuC,iBAAvC,CAAd;AACAqD,QAAAA,GAAG,GAAG,KAAK3C,KAAL,CAAWV,IAAX,CAAgB,QAAhB,CAAN;AACA,YAAI,UAAU,KAAKU,KAAL,CAAWV,IAAX,CAAgB,QAAhB,CAAV,IAAuC,KAAKU,KAAL,CAAWV,IAAX,CAAgB,QAAhB,EAA0B,MAA1B,EAAkC,UAAlC,EAA8C,GAA9C,EAAmD,QAAnD,EAA6DuC,MAA7D,KAAwE,CAAnH,EACIY,KAAK,GAAG,KAAKzC,KAAL,CAAWV,IAAX,CAAgB,QAAhB,EAA0B,MAA1B,EAAkC,UAAlC,EAA8C,GAA9C,EAAmD,QAAnD,EAA6DuD,KAA7D,CAAmE,CAAC,CAApE,EAAuE,CAAvE,EAA0E,MAA1E,CAAR,CADJ,KAGIJ,KAAK,GAAG,qFAAR;AACP,OATD,MASO;AACH5B,QAAAA,KAAK,GAAG,KAAKb,KAAL,CAAWV,IAAX,CAAgB,CAAhB,EAAmB,UAAnB,EAA+B,MAA/B,CAAR;AACAoD,QAAAA,IAAI,GAAG,KAAK1C,KAAL,CAAWV,IAAX,CAAgB,CAAhB,EAAmB,UAAnB,EAA+BuD,KAA/B,CAAqC,CAArC,EAAwC,EAAxC,CAAP;AACAD,QAAAA,WAAW,GAAG,KAAK5C,KAAL,CAAWV,IAAX,CAAgB,CAAhB,EAAmB,UAAnB,CAAd;AACAqD,QAAAA,GAAG,GAAG,KAAK3C,KAAL,CAAWV,IAAX,CAAgB,CAAhB,EAAmB,SAAnB,CAAN;;AACA,YAAI,gBAAgB,KAAKU,KAAL,CAAWV,IAAX,CAAgB,CAAhB,CAAhB,IAAsC,KAAKU,KAAL,CAAWV,IAAX,CAAgB,CAAhB,EAAmB,YAAnB,MAAqC,IAA3E,IAAmF,KAAKU,KAAL,CAAWV,IAAX,CAAgB,CAAhB,EAAmB,YAAnB,EAAiCuC,MAAjC,KAA4C,CAAnI,EAAsI;AAClI,cAAID,CAAC,GAAG,CAAR;;AACA,iBAAOA,CAAC,GAAG,KAAK5B,KAAL,CAAWV,IAAX,CAAgB,CAAhB,EAAmB,YAAnB,EAAiCuC,MAA5C,EAAoDD,CAAC,EAArD,EAAyD;AACrD,gBAAI,KAAK5B,KAAL,CAAWV,IAAX,CAAgB,CAAhB,EAAmB,YAAnB,EAAiCsC,CAAjC,EAAoC,OAApC,KAAgD,IAApD,EACI;AACP;;AACD,cAAIA,CAAC,GAAG,KAAK5B,KAAL,CAAWV,IAAX,CAAgB,CAAhB,EAAmB,YAAnB,EAAiCuC,MAAzC,EAAiD;AAC7C,gBAAIiB,MAAM,GAAG,KAAK9C,KAAL,CAAWV,IAAX,CAAgB,CAAhB,EAAmB,YAAnB,EAAiCsC,CAAjC,EAAoC,KAApC,CAAb;AACA,gBAAIkB,MAAM,CAAC,CAAD,CAAN,KAAc,GAAlB,EACIL,KAAK,GAAG,6BAA6BK,MAArC,CADJ,KAGIL,KAAK,GAAGK,MAAR;AACP,WAND,MAOIL,KAAK,GAAG,oEAAR;AACP,SAdD,MAeIA,KAAK,GAAG,oEAAR;AACP;;AACD,aACI;AAAK,QAAA,KAAK,EAAE;AAACM,UAAAA,SAAS,EAAE;AAAZ,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,cAAD;AACI,QAAA,UAAU,EAAEvE,IADhB;AAEI,QAAA,QAAQ,EAAC,YAFb;AAGI,QAAA,SAAS,EAAE,IAHf;AAII,QAAA,eAAe,MAJnB;AAKI,QAAA,WAAW,EAAE,KALjB;AAMI,QAAA,YAAY,MANhB;AAOI,QAAA,GAAG,EAAE,KAPT;AAQI,QAAA,uBAAuB,MAR3B;AASI,QAAA,SAAS,EAAE,KATf;AAUI,QAAA,YAAY,MAVhB;AAWI,QAAA,aAAa,EAAC,YAXlB;AAYI,QAAA,KAAK,EAAE;AAAC,uBAAa;AAAd,SAZX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,EAeI,oBAAC,OAAD;AAAS,QAAA,IAAI,EAAC,mBAAd;AAAkC,QAAA,SAAS,EAAC,SAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAfJ,EAgBI,oBAAC,IAAD;AAAM,QAAA,SAAS,EAAC,YAAhB;AAA6B,QAAA,GAAG,EAAE,KAAKwD,QAAvC;AAAiD,QAAA,EAAE,EAAC,YAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAK,QAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,IAAD,CAAM,IAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,IAAD,CAAM,KAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAKnB,KAAL,CAAR,CADJ,CADJ,EAII,oBAAC,IAAD,CAAM,IAAN;AAAW,QAAA,KAAK,EAAE;AAAC,0BAAgB;AAAjB,SAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,GAAD;AAAK,QAAA,EAAE,EAAE,CAAT;AAAY,QAAA,EAAE,EAAE,CAAhB;AAAmB,QAAA,EAAE,EAAE,CAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAK6B,IAAL,CADJ,CADJ,EAII,oBAAC,GAAD;AAAK,QAAA,EAAE,EAAE,CAAT;AAAY,QAAA,EAAE,EAAE,CAAhB;AAAmB,QAAA,EAAE,EAAE,CAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,WAAD;AAAa,QAAA,GAAG,EAAEC,GAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,CAJJ,EAOI,oBAAC,GAAD;AAAK,QAAA,EAAE,EAAE,CAAT;AAAY,QAAA,EAAE,EAAE,CAAhB;AAAmB,QAAA,EAAE,EAAE,CAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAG,oBAAS,UAAZ;AACG,oBAAS,cADZ;AAEG,uBAAY,6BAFf;AAGG,QAAA,KAAK,EAAE;AAAC,mBAAS;AAAV,SAHV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAKI,oBAAC,aAAD;AAAe,QAAA,EAAE,EAAC,0BAAlB;AACe,QAAA,OAAO,EAAE,KAAK/B,aAD7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QALJ,EAOI,oBAAC,UAAD;AAAY,QAAA,EAAE,EAAC,wBAAf;AACY,QAAA,OAAO,EAAE,KAAKc,eAD1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAPJ,CADJ,EAWI,oBAAC,YAAD;AACI,QAAA,EAAE,EAAC,cADP;AAEI,QAAA,KAAK,EAAC,KAFV;AAGI,QAAA,MAAM,EAAC,OAHX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAXJ,CAPJ,CADJ,CAJJ,EA+BI;AAAK,QAAA,SAAS,EAAC,2CAAf;AACK,QAAA,KAAK,EAAE;AAAC3B,UAAAA,OAAO,EAAE,MAAV;AAAkBiD,UAAAA,KAAK,EAAE,MAAzB;AAAiCC,UAAAA,MAAM,EAAE;AAAzC,SADZ;AAEK,QAAA,EAAE,EAAC,WAFR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAII,oBAAC,KAAD;AAAO,QAAA,SAAS,EAAC,WAAjB;AAA6B,QAAA,GAAG,EAAER,KAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJJ,CA/BJ,EAqCI,oBAAC,IAAD,CAAM,IAAN;AAAW,QAAA,SAAS,EAAC,mBAArB;AAAyC,QAAA,GAAG,EAAE,KAAKhD,MAAnD;AAA2D,QAAA,EAAE,EAAC,mBAA9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACKmD,WADL,CArCJ,EAwCI,oBAAC,cAAD;AACI,QAAA,KAAK,EAAE;AAAC,oBAAU,OAAX;AAAoB,mBAAS,OAA7B;AAAsC,mBAAS;AAA/C,SADX;AAEI,QAAA,OAAO,EAAE,KAAKzC,MAFlB;AAGI,QAAA,EAAE,EAAC,YAHP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAxCJ,CADJ,CADJ,CAhBJ,EAkEI,oBAAC,IAAD;AAAM,QAAA,SAAS,EAAC,YAAhB;AAA6B,QAAA,GAAG,EAAE,KAAK+B,MAAvC;AAA+C,QAAA,EAAE,EAAC,UAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAK,QAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,IAAD,CAAM,IAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,IAAD,CAAM,KAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAKrB,KAAL,CAAR,CADJ,CADJ,EAII,oBAAC,IAAD,CAAM,IAAN;AAAW,QAAA,KAAK,EAAE;AAAC,0BAAgB;AAAjB,SAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,GAAD;AAAK,QAAA,EAAE,EAAE,CAAT;AAAY,QAAA,EAAE,EAAE,CAAhB;AAAmB,QAAA,EAAE,EAAE,CAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAK6B,IAAL,CADJ,CADJ,EAII,oBAAC,GAAD;AAAK,QAAA,EAAE,EAAE,CAAT;AAAY,QAAA,EAAE,EAAE,CAAhB;AAAmB,QAAA,EAAE,EAAE,CAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,WAAD;AAAa,QAAA,GAAG,EAAEC,GAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,CAJJ,EAOI,oBAAC,GAAD;AAAK,QAAA,EAAE,EAAE,CAAT;AAAY,QAAA,EAAE,EAAE,CAAhB;AAAmB,QAAA,EAAE,EAAE,CAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAG,oBAAS,UAAZ;AACG,oBAAS,cADZ;AAEG,uBAAY,6BAFf;AAGG,QAAA,KAAK,EAAE;AAAC,mBAAS;AAAV,SAHV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAKI,oBAAC,aAAD;AAAe,QAAA,EAAE,EAAC,wBAAlB;AACe,QAAA,OAAO,EAAE,KAAK/B,aAD7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QALJ,EAOI,oBAAC,UAAD;AAAY,QAAA,EAAE,EAAC,sBAAf;AACY,QAAA,OAAO,EAAE,KAAKc,eAD1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAPJ,CADJ,EAWI,oBAAC,YAAD;AACI,QAAA,EAAE,EAAC,cADP;AAEI,QAAA,KAAK,EAAC,KAFV;AAGI,QAAA,MAAM,EAAC,OAHX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAXJ,CAPJ,CADJ,CAJJ,EA+BI;AAAK,QAAA,SAAS,EAAC,2CAAf;AACK,QAAA,KAAK,EAAE;AAAC3B,UAAAA,OAAO,EAAE,MAAV;AAAkBiD,UAAAA,KAAK,EAAE,MAAzB;AAAiCC,UAAAA,MAAM,EAAE;AAAzC,SADZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEI,oBAAC,KAAD;AAAO,QAAA,SAAS,EAAC,WAAjB;AAA6B,QAAA,GAAG,EAAER,KAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFJ,CA/BJ,EAmCI,oBAAC,OAAD;AAAS,QAAA,IAAI,EAAC,kBAAd;AAAiC,QAAA,SAAS,EAAC,SAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAnCJ,EAoCI,oBAAC,IAAD,CAAM,IAAN;AAAW,QAAA,SAAS,EAAC,mBAArB;AAAyC,QAAA,EAAE,EAAC,iBAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACKG,WADL,CApCJ,EAuCI,oBAAC,YAAD;AACI,QAAA,KAAK,EAAE;AAAC,oBAAU,OAAX;AAAoB,mBAAS,OAA7B;AAAsC,mBAAS;AAA/C,SADX;AAEI,QAAA,OAAO,EAAE,KAAKvC,IAFlB;AAGI,QAAA,EAAE,EAAC,UAHP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAvCJ,CADJ,CADJ,CAlEJ,CADJ,EAqHI,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,OAAD;AAAS,QAAA,EAAE,EAAE,KAAKxB,KAAL,CAAWE,EAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,CArHJ,CADJ;AA2HH;AACJ;;AA9UuC;;AAiV5C,eAAeL,aAAf","sourcesContent":["import React from \"react\";\r\nimport Card from \"react-bootstrap/Card\";\r\nimport Row from \"react-bootstrap/Row\";\r\nimport Col from \"react-bootstrap/Col\";\r\nimport Image from \"react-bootstrap/Image\";\r\nimport LoadSpinner from \"./LoadSpinner\";\r\nimport DetailShare from \"./DetailShare\";\r\nimport {FaRegBookmark, FaBookmark, IoIosArrowDown, IoIosArrowUp} from \"react-icons/all\";\r\nimport {Element, animateScroll as scroll, scroller} from 'react-scroll';\r\nimport {Events} from \"react-scroll\";\r\nimport ReactTooltip from \"react-tooltip\";\r\nimport {toast, ToastContainer, Zoom} from \"react-toastify\";\r\nimport Comment from \"./Comment\";\r\n\r\nclass DetailArticle extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        let isBookmarked = false;\r\n        if (window.localStorage.getItem(\"bookmarks\")) {\r\n            let bookmarks = JSON.parse(window.localStorage.getItem(\"bookmarks\"));\r\n            for (let i = 0; i < bookmarks.length; i++) {\r\n                if (bookmarks[i] === props.id) {\r\n                    isBookmarked = true;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        this.state = {\r\n            error: null,\r\n            isLoaded: false,\r\n            data: [],\r\n            GuardianChecked: props.checked,\r\n            id: props.id,\r\n            bookmarkChecked: isBookmarked\r\n        };\r\n        this.smallRef = React.createRef();\r\n        this.desRef = React.createRef();\r\n        this.bigRef = React.createRef();\r\n    }\r\n\r\n    callGuardian = (id) => {\r\n        fetch(\"https://yli59322-hw8-571-backend.appspot.com/guardian/article\" + id)\r\n            .then(res => res.json())\r\n            .then(\r\n                res => {\r\n                    this.setState({isLoaded: true, data: res['response']['content']});\r\n                }, error => {\r\n                    this.setState({isLoaded: true, error});\r\n                })\r\n            .then(\r\n                () => {\r\n                    this.setState({scrollHeight: this.desRef.current.scrollHeight});\r\n                    this.setState({clientHeight: this.desRef.current.clientHeight});\r\n                    if (this.desRef.current.scrollHeight === this.desRef.current.clientHeight)\r\n                        document.getElementById(\"arrow-down\").style.display = \"none\";\r\n                    if (this.state.bookmarkChecked) {\r\n                        document.getElementById(\"small-bookmark-unchecked\").style.display = \"none\";\r\n                        document.getElementById(\"small-bookmark-checked\").style.display = \"block\";\r\n                        document.getElementById(\"big-bookmark-unchecked\").style.display = \"none\";\r\n                        document.getElementById(\"big-bookmark-checked\").style.display = \"block\";\r\n                    }\r\n                }\r\n            )\r\n    };\r\n\r\n    callNYTimes = (id) => {\r\n        fetch(\"https://yli59322-hw8-571-backend.appspot.com/nytimes/article\" + id)\r\n            .then(res => res.json())\r\n            .then(\r\n                res => {\r\n                    this.setState({isLoaded: true, data: res['response']['docs']});\r\n                }, error => {\r\n                    this.setState({isLoaded: true, error});\r\n                })\r\n            .then(\r\n                () => {\r\n                    this.setState({scrollHeight: this.desRef.current.scrollHeight});\r\n                    this.setState({clientHeight: this.desRef.current.clientHeight});\r\n                    if (this.desRef.current.scrollHeight === this.desRef.current.clientHeight)\r\n                        document.getElementById(\"arrow-down\").style.display = \"none\";\r\n                    if (this.state.bookmarkChecked) {\r\n                        document.getElementById(\"small-bookmark-unchecked\").style.display = \"none\";\r\n                        document.getElementById(\"small-bookmark-checked\").style.display = \"block\";\r\n                        document.getElementById(\"big-bookmark-unchecked\").style.display = \"none\";\r\n                        document.getElementById(\"big-bookmark-checked\").style.display = \"block\";\r\n                    }\r\n                }\r\n            )\r\n    };\r\n\r\n    componentDidMount() {\r\n        if (this.state.GuardianChecked)\r\n            this.callGuardian(this.state.id);\r\n        else\r\n            this.callNYTimes(this.state.id);\r\n        Events.scrollEvent.register('begin', function () {\r\n            console.log(\"begin\", arguments);\r\n        });\r\n\r\n        Events.scrollEvent.register('end', function () {\r\n            console.log(\"end\", arguments);\r\n            if (arguments[0] === \"scroll-to-element\") {\r\n                document.getElementById(\"small-card\").style.display = \"flex\";\r\n                document.getElementById(\"big-card\").style.display = \"none\";\r\n            }\r\n        });\r\n    }\r\n\r\n    expand = () => {\r\n        document.getElementById(\"small-card\").style.display = \"none\";\r\n        document.getElementById(\"big-card\").style.display = \"flex\";\r\n        this.scrollToBottom();\r\n    };\r\n\r\n    fold = () => {\r\n        this.scrollUp();\r\n    };\r\n\r\n    scrollToBottom = () => {\r\n        scroller.scrollTo('scroll-to-bottom', {\r\n            duration: 800,\r\n            delay: 0,\r\n            smooth: true,\r\n            offset: this.state.clientHeight\r\n        })\r\n    };\r\n\r\n    scrollUp = () => {\r\n        scroller.scrollTo('scroll-to-element', {\r\n            duration: 800,\r\n            delay: 0,\r\n            smooth: true\r\n        })\r\n    };\r\n\r\n    bookmarkClick = () => {\r\n        document.getElementById(\"small-bookmark-unchecked\").style.display = \"none\";\r\n        document.getElementById(\"small-bookmark-checked\").style.display = \"block\";\r\n        document.getElementById(\"big-bookmark-unchecked\").style.display = \"none\";\r\n        document.getElementById(\"big-bookmark-checked\").style.display = \"block\";\r\n        let title;\r\n        if (this.state.GuardianChecked)\r\n            title = this.state.data['webTitle'];\r\n        else\r\n            title = this.state.data[0]['headline']['main'];\r\n        toast(\"Saving \" + title);\r\n        let bookmarks;\r\n        if (window.localStorage.getItem(\"bookmarks\")) {\r\n            bookmarks = JSON.parse(window.localStorage.getItem(\"bookmarks\"));\r\n        } else {\r\n            bookmarks = [];\r\n        }\r\n        bookmarks.push(this.state.id);\r\n        window.localStorage.setItem(\"bookmarks\", JSON.stringify(bookmarks));\r\n        console.log(JSON.parse(window.localStorage.getItem(\"bookmarks\")));\r\n    };\r\n\r\n    bookmarkUnClick = () => {\r\n        document.getElementById(\"small-bookmark-unchecked\").style.display = \"block\";\r\n        document.getElementById(\"small-bookmark-checked\").style.display = \"none\";\r\n        document.getElementById(\"big-bookmark-unchecked\").style.display = \"block\";\r\n        document.getElementById(\"big-bookmark-checked\").style.display = \"none\";\r\n        let title;\r\n        if (this.state.GuardianChecked)\r\n            title = this.state.data['webTitle'];\r\n        else\r\n            title = this.state.data[0]['headline']['main'];\r\n        toast(\"Removing - \" + title);\r\n        let bookmarks = JSON.parse(window.localStorage.getItem(\"bookmarks\"));\r\n        let newbookmarks = [];\r\n        for (let i = 0; i < bookmarks.length; i++) {\r\n            if (bookmarks[i] !== this.state.id)\r\n                newbookmarks.push(bookmarks[i]);\r\n        }\r\n        window.localStorage.setItem(\"bookmarks\", JSON.stringify(newbookmarks));\r\n        console.log(JSON.parse(window.localStorage.getItem(\"bookmarks\")));\r\n    };\r\n\r\n    render() {\r\n        if (this.state.error) {\r\n            return <div>Error: {this.state.error.message}</div>;\r\n        } else if (!this.state.isLoaded) {\r\n            return (\r\n                <div className=\"load-container\">\r\n                    <LoadSpinner/>\r\n                </div>\r\n            );\r\n        } else {\r\n            let title;\r\n            let image;\r\n            let date;\r\n            let url;\r\n            let description;\r\n            if (this.state.GuardianChecked) {\r\n                title = this.state.data['webTitle'];\r\n                date = this.state.data['webPublicationDate'].slice(0, 10);\r\n                description = this.state.data['blocks']['body']['0']['bodyTextSummary'];\r\n                url = this.state.data['webUrl'];\r\n                if ('main' in this.state.data['blocks'] && this.state.data['blocks']['main']['elements']['0']['assets'].length !== 0)\r\n                    image = this.state.data['blocks']['main']['elements']['0']['assets'].slice(-1)[0]['file'];\r\n                else\r\n                    image = 'https://assets.guim.co.uk/images/eada8aa27c12fe2d5afa3a89d3fbae0d/fallback-logo.png';\r\n            } else {\r\n                title = this.state.data[0]['headline']['main'];\r\n                date = this.state.data[0]['pub_date'].slice(0, 10);\r\n                description = this.state.data[0]['abstract'];\r\n                url = this.state.data[0]['web_url'];\r\n                if ('multimedia' in this.state.data[0] && this.state.data[0]['multimedia'] !== null && this.state.data[0]['multimedia'].length !== 0) {\r\n                    let i = 0;\r\n                    for (; i < this.state.data[0]['multimedia'].length; i++) {\r\n                        if (this.state.data[0]['multimedia'][i]['width'] >= 2000)\r\n                            break;\r\n                    }\r\n                    if (i < this.state.data[0]['multimedia'].length) {\r\n                        let tmpUrl = this.state.data[0]['multimedia'][i]['url'];\r\n                        if (tmpUrl[0] === 'i')\r\n                            image = 'https://www.nytimes.com/' + tmpUrl;\r\n                        else\r\n                            image = tmpUrl;\r\n                    } else\r\n                        image = 'https://upload.wikimedia.org/wikipedia/commons/0/0e/Nytimes_hq.jpg';\r\n                } else\r\n                    image = 'https://upload.wikimedia.org/wikipedia/commons/0/0e/Nytimes_hq.jpg';\r\n            }\r\n            return (\r\n                <div style={{boxSizing: \"content-box\"}}>\r\n                    <Row>\r\n                        <ToastContainer\r\n                            transition={Zoom}\r\n                            position=\"top-center\"\r\n                            autoClose={3000}\r\n                            hideProgressBar\r\n                            newestOnTop={false}\r\n                            closeOnClick\r\n                            rtl={false}\r\n                            pauseOnVisibilityChange\r\n                            draggable={false}\r\n                            pauseOnHover\r\n                            bodyClassName=\"toast-body\"\r\n                            style={{\"font-size\": \"0.8rem\"}}\r\n                        />\r\n                        <Element name=\"scroll-to-element\" className=\"element\"></Element>\r\n                        <Card className=\"detailCard\" ref={this.smallRef} id=\"small-card\">\r\n                            <div className=\"container-fluid\">\r\n                                <Card.Body>\r\n                                    <Card.Title>\r\n                                        <strong><em>{title}</em></strong>\r\n                                    </Card.Title>\r\n                                    <Card.Text style={{\"marginBottom\": 0}}>\r\n                                        <Row>\r\n                                            <Col md={8} sm={5} xs={5}>\r\n                                                <em>{date}</em>\r\n                                            </Col>\r\n                                            <Col md={3} sm={5} xs={5}>\r\n                                                <DetailShare url={url}/>\r\n                                            </Col>\r\n                                            <Col md={1} sm={2} xs={2}>\r\n                                                <p data-tip=\"Bookmark\"\r\n                                                   data-for=\"BookmarkDeTT\"\r\n                                                   data-offset=\"{'left' : -5, 'right' : -5}\"\r\n                                                   style={{\"float\": \"right\"}}\r\n                                                >\r\n                                                    <FaRegBookmark id=\"small-bookmark-unchecked\"\r\n                                                                   onClick={this.bookmarkClick}/>\r\n                                                    <FaBookmark id=\"small-bookmark-checked\"\r\n                                                                onClick={this.bookmarkUnClick}/>\r\n                                                </p>\r\n                                                <ReactTooltip\r\n                                                    id=\"BookmarkDeTT\"\r\n                                                    place=\"top\"\r\n                                                    effect=\"solid\"\r\n                                                />\r\n                                            </Col>\r\n                                        </Row>\r\n                                    </Card.Text>\r\n                                    <div className=\"align-items-center justify-content-center\"\r\n                                         style={{display: \"flex\", width: \"100%\", height: \"100%\"}}\r\n                                         id=\"scroll-to\"\r\n                                    >\r\n                                        <Image className=\"img-fluid\" src={image}/>\r\n                                    </div>\r\n                                    <Card.Text className=\"detailDescription\" ref={this.desRef} id=\"small-description\">\r\n                                        {description}\r\n                                    </Card.Text>\r\n                                    <IoIosArrowDown\r\n                                        style={{\"height\": \"1.5em\", \"width\": \"1.5em\", \"float\": \"right\"}}\r\n                                        onClick={this.expand}\r\n                                        id=\"arrow-down\"\r\n                                    />\r\n                                </Card.Body>\r\n                            </div>\r\n                        </Card>\r\n                        <Card className=\"detailCard\" ref={this.bigRef} id=\"big-card\">\r\n                            <div className=\"container-fluid\">\r\n                                <Card.Body>\r\n                                    <Card.Title>\r\n                                        <strong><em>{title}</em></strong>\r\n                                    </Card.Title>\r\n                                    <Card.Text style={{\"marginBottom\": 0}}>\r\n                                        <Row>\r\n                                            <Col md={8} sm={5} xs={5}>\r\n                                                <em>{date}</em>\r\n                                            </Col>\r\n                                            <Col md={3} sm={5} xs={5}>\r\n                                                <DetailShare url={url}/>\r\n                                            </Col>\r\n                                            <Col md={1} sm={2} xs={2}>\r\n                                                <p data-tip=\"Bookmark\"\r\n                                                   data-for=\"BookmarkDeTT\"\r\n                                                   data-offset=\"{'left' : -5, 'right' : -5}\"\r\n                                                   style={{\"float\": \"right\"}}\r\n                                                >\r\n                                                    <FaRegBookmark id=\"big-bookmark-unchecked\"\r\n                                                                   onClick={this.bookmarkClick}/>\r\n                                                    <FaBookmark id=\"big-bookmark-checked\"\r\n                                                                onClick={this.bookmarkUnClick}/>\r\n                                                </p>\r\n                                                <ReactTooltip\r\n                                                    id=\"BookmarkDeTT\"\r\n                                                    place=\"top\"\r\n                                                    effect=\"solid\"\r\n                                                />\r\n                                            </Col>\r\n                                        </Row>\r\n                                    </Card.Text>\r\n                                    <div className=\"align-items-center justify-content-center\"\r\n                                         style={{display: \"flex\", width: \"100%\", height: \"100%\"}}>\r\n                                        <Image className=\"img-fluid\" src={image}/>\r\n                                    </div>\r\n                                    <Element name=\"scroll-to-bottom\" className=\"element\"></Element>\r\n                                    <Card.Text className=\"detailDescription\" id=\"big-description\">\r\n                                        {description}\r\n                                    </Card.Text>\r\n                                    <IoIosArrowUp\r\n                                        style={{\"height\": \"1.5em\", \"width\": \"1.5em\", \"float\": \"right\"}}\r\n                                        onClick={this.fold}\r\n                                        id=\"arrow-up\"\r\n                                    />\r\n                                </Card.Body>\r\n                            </div>\r\n                        </Card>\r\n                    </Row>\r\n                    <Row>\r\n                        <Comment id={this.props.id}/>\r\n                    </Row>\r\n                </div>\r\n            );\r\n        }\r\n    }\r\n}\r\n\r\nexport default DetailArticle;"]},"metadata":{},"sourceType":"module"}